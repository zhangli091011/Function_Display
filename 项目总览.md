# 数学函数计算器 - 项目总览

## 🎯 项目简介

这是一个专为**中学数学教学**设计的函数计算与图像绘制客户端程序，完全使用 Python 开发，无需联网即可使用。

### 核心特性
✅ 自定义表达式解析器（非 eval）  
✅ 支持幂函数、三角函数、对数函数  
✅ 符号求导功能  
✅ 函数图像绘制  
✅ 智能结果格式化（整数 > π/e > 分数 > 小数）  
✅ PyQt5 图形界面  
✅ 完全离线运行  

---

## 📦 项目文件

### 核心代码（7个文件）
| 文件 | 功能 | 行数 |
|------|------|------|
| `lexer.py` | 词法分析器 | ~150 |
| `parser.py` | 语法分析器（AST） | ~200 |
| `evaluator.py` | 数值计算器 | ~150 |
| `derivative.py` | 符号求导器 | ~250 |
| `plotter.py` | 函数绘图器 | ~80 |
| `ui.py` | PyQt5 用户界面 | ~300 |
| `main.py` | 程序入口 | ~20 |

### 辅助文件
- `test_calculator.py` - 核心功能测试
- `requirements.txt` - Python 依赖
- `README.md` - 项目说明
- `使用说明.md` - 详细使用指南
- `项目结构说明.md` - 技术文档
- `启动程序.bat` - Windows 快速启动
- `安装依赖.bat` - Windows 依赖安装

---

## 🚀 快速开始

### Windows 用户
1. 双击运行 `安装依赖.bat`
2. 双击运行 `启动程序.bat`

### 其他系统
```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 运行程序
python main.py

# 3. 测试功能（可选）
python test_calculator.py
```

---

## 💡 功能演示

### 1️⃣ 数值计算
```
输入：f(x) = x^2 + sin(x)
     x = pi
输出：f(pi) = π²
     （小数形式：9.8696）
```

### 2️⃣ 符号求导
```
输入：f(x) = x^3 + 2*x^2 - 5*x + 1
输出：f'(x) = 3*x^2 + 4*x - 5
```

### 3️⃣ 函数绘图
```
输入：f(x) = sin(x) + cos(x)
操作：点击"绘图"
结果：显示蓝色曲线
```

### 4️⃣ 导函数绘制
```
输入：f(x) = x^2
操作：点击"绘制导函数"
结果：蓝色实线（原函数）+ 红色虚线（导函数）
```

---

## 📚 支持的数学表达式

### 运算符
- `+` 加法
- `-` 减法
- `*` 乘法
- `/` 除法
- `^` 幂运算

### 函数
- `sin(x)` - 正弦函数
- `cos(x)` - 余弦函数
- `log(x)` - 自然对数
- `log(a, x)` - 以 a 为底的对数

### 常数
- `pi` 或 `π` - 圆周率
- `e` - 自然常数

### 复合函数
- `sin(x^2)` - 三角函数复合幂函数
- `log(sin(x))` - 对数复合三角函数
- `x^2 + 3*sin(x) - log(x)` - 多项式与函数混合

---

## 🧪 测试结果

运行 `python test_calculator.py` 的输出：

```
✅ x^2 (x=3) → 结果: 9, 导数: 2*x
✅ x^2 + sin(x) (x=π) → 结果: 9.8696, 导数: 2*x + cos(x)
✅ 2^x (x=3) → 结果: 8, 导数: 2^x * ln(2)
✅ sin(x) + cos(x) (x=0) → 结果: 1, 导数: cos(x) - sin(x)
✅ log(x) (x=e) → 结果: 1, 导数: 1/x
✅ x^3 + 2*x^2 - 5*x + 1 (x=2) → 结果: 7
✅ sin(x^2) (x=1) → 结果: 0.8415, 导数: cos(x^2) * 2*x
```

所有测试通过！✅

---

## 🏗️ 技术架构

### 技术栈
- **语言**：Python 3.7+
- **UI 框架**：PyQt5
- **绘图库**：Matplotlib
- **数值计算**：NumPy

### 架构设计
```
用户输入
   ↓
词法分析 (Lexer)
   ↓
语法分析 (Parser) → AST
   ↓
├─ 数值计算 (Evaluator)
├─ 符号求导 (Derivative)
└─ 函数绘图 (Plotter)
   ↓
结果显示 (UI)
```

### 设计亮点
1. **自定义解析器**：完全手写词法和语法分析，不依赖 eval
2. **AST 结构**：使用抽象语法树，便于扩展
3. **模块化设计**：每个模块职责单一，易于维护
4. **教学导向**：输出格式优化，适合课堂演示

---

## 📖 文档导航

- **新手入门** → 阅读 `使用说明.md`
- **技术细节** → 阅读 `项目结构说明.md`
- **功能概览** → 阅读 `README.md`
- **快速测试** → 运行 `test_calculator.py`

---

## 🎓 教学应用场景

### 场景 1：函数性质演示
- 输入 `x^2` 和 `x^3`，对比图像
- 观察偶函数和奇函数的对称性

### 场景 2：导数与单调性
- 输入 `x^3 - 3*x`
- 绘制原函数和导函数
- 观察导数正负与函数增减的关系

### 场景 3：三角函数周期
- 输入 `sin(x)` 和 `sin(2*x)`
- 对比周期变化

### 场景 4：复合函数求导
- 输入 `sin(x^2)`
- 展示链式法则：`cos(x^2) * 2*x`

---

## ⚙️ 系统要求

- **操作系统**：Windows / macOS / Linux
- **Python 版本**：3.7 或更高
- **内存**：至少 512MB
- **磁盘空间**：约 100MB（含依赖）

---

## 🔧 故障排除

### 问题 1：程序无法启动
**原因**：缺少依赖包  
**解决**：运行 `pip install -r requirements.txt`

### 问题 2：表达式解析错误
**原因**：语法错误  
**解决**：检查括号匹配、函数名拼写

### 问题 3：图像不显示
**原因**：函数在定义域外  
**解决**：检查函数定义域（如 log(x) 要求 x>0）

### 问题 4：中文显示乱码（Windows）
**原因**：终端编码问题  
**解决**：启动脚本已自动设置 UTF-8 编码

---

## 📈 版本规划

### ✅ Phase 1（当前版本 1.0）
- [x] 基础表达式解析
- [x] 数值计算
- [x] 符号求导
- [x] 函数绘图
- [x] PyQt5 界面

### 🔄 Phase 2（计划中）
- [ ] 表达式自动简化
- [ ] 更多函数（tan, arcsin, sqrt）
- [ ] 隐式乘法支持（2x → 2*x）
- [ ] 求导步骤显示
- [ ] 极值点自动标注
- [ ] 保存/加载功能
- [ ] 导出图像（PNG/PDF）

### 🚀 Phase 3（未来）
- [ ] 多变量函数
- [ ] 三维图像
- [ ] 积分计算
- [ ] 方程求解
- [ ] 在线题库

---

## 👥 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 本项目
2. 创建功能分支 (`git checkout -b feature/新功能`)
3. 提交更改 (`git commit -m '添加新功能'`)
4. 推送到分支 (`git push origin feature/新功能`)
5. 创建 Pull Request

### 代码规范
- 遵循 PEP 8
- 添加中文注释
- 编写单元测试
- 更新文档

---

## 📄 许可证

本项目采用 MIT 许可证，可自由用于教学和学习。

---

## 🙏 致谢

感谢以下开源项目：
- **PyQt5** - 强大的 GUI 框架
- **Matplotlib** - 优秀的绘图库
- **NumPy** - 高效的数值计算

---

## 📞 联系方式

- **项目名称**：数学函数计算器
- **版本**：1.0 (Phase 1)
- **开发者**：数学教学工具开发组
- **开发日期**：2026年1月

---

## 🎉 开始使用

现在就运行 `python main.py` 开始探索数学的奥秘吧！

如有问题，请查阅 `使用说明.md` 或运行测试脚本验证安装。
