# 数学函数计算器 - 使用说明

## 快速开始

### 1. 安装依赖
```bash
pip install PyQt5 matplotlib numpy
```

或使用 requirements.txt：
```bash
pip install -r requirements.txt
```

### 2. 运行程序
```bash
python main.py
```

### 3. 测试核心功能（可选）
```bash
python test_calculator.py
```

## 界面说明

### 左侧面板
- **函数输入框**：输入数学表达式，如 `x^2 + sin(x)`
- **x 值输入框**：用于数值计算时指定 x 的值
- **计算结果区**：显示计算结果、导函数等信息
- **按钮区**：
  - 数字键：0-9 和小数点
  - 运算符：+ - * / ^
  - 函数键：sin、cos、log、π、e
  - 功能键：= 计算、绘图、求导、清除

### 右侧面板
- **函数图像区**：显示函数和导函数的图像
- **清除图像按钮**：清空绘图区

## 功能详解

### 📊 数值计算
1. 在"函数输入"框输入表达式，如：`x^2 + 3*x - 1`
2. 在"x 值"框输入数值，如：`2` 或 `pi`
3. 点击"= 计算"按钮
4. 结果会以最优形式显示（整数 > π/e 倍数 > 分数 > 小数）

**示例**：
- 输入：`f(x) = sin(x)`, `x = pi`
- 输出：`f(pi) = 0`

### 📈 函数绘图
1. 输入函数表达式
2. 点击"绘图"按钮
3. 函数图像显示在右侧（默认范围 x ∈ [-10, 10]）

**示例**：
- 输入：`x^2 - 4`
- 点击"绘图"
- 显示抛物线

### 🔄 符号求导
1. 输入函数表达式
2. 点击"求导"按钮
3. 导函数表达式显示在结果区

**示例**：
- 输入：`x^3 + 2*x`
- 输出：`f'(x) = 3*x^2 + 2`

### 📊 绘制导函数
1. 输入函数表达式
2. 点击"绘制导函数"按钮
3. 原函数（蓝色实线）和导函数（红色虚线）同时显示

## 支持的数学表达式

### 基本运算
- 加法：`x + 2`
- 减法：`x - 3`
- 乘法：`2 * x` 或 `2*x`
- 除法：`x / 2`
- 幂运算：`x^2`, `2^x`

### 函数
- **三角函数**：`sin(x)`, `cos(x)`
- **对数函数**：
  - `log(x)` - 自然对数 ln(x)
  - `log(2, x)` - 以 2 为底 x 的对数
- **复合函数**：`sin(x^2)`, `log(sin(x))`

### 常数
- **圆周率**：`pi` 或点击 `π` 按钮
- **自然常数**：`e`

### 括号
- 使用括号改变运算顺序：`(x + 1) * (x - 1)`

## 输入技巧

### 使用按钮输入
- 点击数字和运算符按钮
- 点击函数按钮会自动添加左括号
- 使用 ← → 按钮移动光标
- 使用"退格"按钮删除字符

### 键盘输入
- 直接在输入框中输入表达式
- 支持复制粘贴

## 常见示例

### 示例 1：二次函数
```
函数：x^2 - 4*x + 3
x = 2
结果：f(2) = -1
导函数：f'(x) = 2*x - 4
```

### 示例 2：三角函数
```
函数：sin(x) + cos(x)
x = pi
结果：f(pi) = -1
导函数：f'(x) = cos(x) - sin(x)
```

### 示例 3：指数函数
```
函数：2^x
x = 3
结果：f(3) = 8
导函数：f'(x) = 2^x * ln(2)
```

### 示例 4：复合函数
```
函数：sin(x^2)
x = 1
结果：f(1) = 0.8415
导函数：f'(x) = cos(x^2) * 2*x
```

### 示例 5：对数函数
```
函数：log(2, x)  # 以2为底
x = 8
结果：f(8) = 3
导函数：f'(x) = 1 / (x * ln(2))
```

## 注意事项

1. **三角函数使用弧度制**
   - π ≈ 3.14159
   - sin(π) = 0
   - cos(π) = -1

2. **对数函数定义域**
   - log(x) 要求 x > 0
   - log(a, x) 要求 a > 0 且 a ≠ 1

3. **幂运算优先级**
   - `2^3^2` = `2^(3^2)` = 512（右结合）
   - 建议使用括号明确优先级

4. **除零错误**
   - 避免除数为零的表达式
   - 如 `1/x` 在 x=0 时无定义

## 故障排除

### 问题：程序无法启动
**解决**：检查是否安装了所有依赖
```bash
pip install PyQt5 matplotlib numpy
```

### 问题：表达式解析错误
**解决**：
- 检查括号是否匹配
- 检查函数名拼写（sin, cos, log）
- 确保运算符前后有操作数

### 问题：图像不显示
**解决**：
- 检查函数是否在定义域内
- 尝试调整 x 范围
- 点击"清除图像"后重新绘制

### 问题：导数表达式过于复杂
**说明**：当前版本输出未简化的导数表达式，这是正常的。Phase 2 将添加表达式简化功能。

## 教学应用场景

1. **函数性质演示**
   - 展示函数的增减性
   - 观察导数与函数单调性的关系

2. **极值点分析**
   - 找到 f'(x) = 0 的点
   - 观察原函数在该点的极值

3. **函数变换**
   - 比较 f(x) 和 f(x+a) 的图像
   - 观察平移、伸缩变换

4. **复合函数理解**
   - 输入 sin(x) 和 sin(2*x)
   - 观察周期变化

## 技术支持

如遇到问题，请检查：
1. Python 版本（建议 3.7+）
2. 依赖包版本
3. 运行 `python test_calculator.py` 测试核心功能

## 版本信息

- **当前版本**：1.0 (Phase 1)
- **开发状态**：基础功能完整
- **计划更新**：表达式简化、更多函数支持
